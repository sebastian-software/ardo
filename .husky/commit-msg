msg_file="$1"
first_line="$(sed -n '1p' "$msg_file")"

if echo "$first_line" | grep -Eq "^(Merge|Revert) "; then
  exit 0
fi

if echo "$first_line" | grep -Eq "^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\([a-z0-9._/-]+\))?(!)?: .+"; then
  exit 0
fi

echo "Invalid commit message: '$first_line'"
echo "Use Conventional Commits, e.g. 'fix(ardo): preserve basename in search navigation'."
exit 1
